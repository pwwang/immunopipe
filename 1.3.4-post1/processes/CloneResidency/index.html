<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>CloneResidency - immunopipe</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../assets/style.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "CloneResidency";
        var mkdocs_page_input_path = "processes/CloneResidency.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.configure({ ignoreUnescapedHTML: true }); hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../..">
          <img src="../../rtd-logo.png" class="logo" alt="Logo"/>
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="nav-scrollable-wrapper">
      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../introduction/">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../getting-started/">Geting started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../gallery/">Gallery</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../running/">Running the pipeline</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../preparing-input/">Preparing the input</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../configurations/">Configurations</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Processes</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../SampleInfo/">SampleInfo</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ImmunarchLoading/">ImmunarchLoading</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SeuratPreparing/">SeuratPreparing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SeuratClusteringOfAllCells/">SeuratClusteringOfAllCells</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ClusterMarkersOfAllCells/">ClusterMarkersOfAllCells</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TopExpressingGenesOfAllCells/">TopExpressingGenesOfAllCells</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TCellSelection/">TCellSelection</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ModuleScoreCalculator/">ModuleScoreCalculator</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SeuratClustering/">SeuratClustering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SeuratMap2Ref/">SeuratMap2Ref</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CellTypeAnnotation/">CellTypeAnnotation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SeuratSubClustering/">SeuratSubClustering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TCRClustering/">TCRClustering</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TCRClusterStats/">TCRClusterStats</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IntegratingTCRClusters/">IntegratingTCRClusters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ClusterMarkers/">ClusterMarkers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TopExpressingGenes/">TopExpressingGenes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Immunarch/">Immunarch</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../TESSA/">TESSA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../IntegratingTCR/">IntegratingTCR</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../SeuratClusterStats/">SeuratClusterStats</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../RadarPlots/">RadarPlots</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">CloneResidency</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#environment-variables">Environment Variables</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ScFGSEA/">ScFGSEA</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CellsDistribution/">CellsDistribution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MarkersFinder/">MarkersFinder</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetaMarkers/">MetaMarkers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../CDR3AAPhyschem/">CDR3AAPhyschem</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Metabolic Landscape Analysis</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../ScrnaMetabolicLandscape/">Introduction & Group Arguments</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetabolicInput/">MetabolicInput</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetabolicExprImpution/">MetabolicExprImpution</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetabolicFeatures/">MetabolicFeatures</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetabolicFeaturesIntraSubset/">MetabolicFeaturesIntraSubset</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetabolicPathwayActivity/">MetabolicPathwayActivity</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MetabolicPathwayHeterogeneity/">MetabolicPathwayHeterogeneity</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../faq/">FAQ</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../CHANGELOG/">Change log</a>
                </li>
              </ul>
      </div>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">immunopipe</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Processes</li>
      <li class="breadcrumb-item active">CloneResidency</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/pwwang/immunopipe/blob/dev/docs/processes/CloneResidency.md">Edit on pwwang/immunopipe</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="cloneresidency">CloneResidency<a class="headerlink" href="#cloneresidency" title="Permanent link">&para;</a></h2>
<p>Identification of clone residency</p>
<p>This process is used to investigate the residency of clones in groups, typically two
samples (e.g. tumor and normal) from the same patient. But it can be used for any two groups of clones.<br /></p>
<p>There are three types of output from this process</p>
<ul>
<li>
<p>Count tables of the clones in the two groups</p>
<table>
<thead>
<tr>
<th>CDR3_aa</th>
<th>Tumor</th>
<th>Normal</th>
</tr>
</thead>
<tbody>
<tr>
<td>CASSYGLSWGSYEQYF</td>
<td>306</td>
<td>55</td>
</tr>
<tr>
<td>CASSVTGAETQYF</td>
<td>295</td>
<td>37</td>
</tr>
<tr>
<td>CASSVPSAHYNEQFF</td>
<td>197</td>
<td>9</td>
</tr>
<tr>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>Residency plots showing the residency of clones in the two groups</p>
<p><img alt="CloneResidency_residency" src="https://pwwang.github.io/immunopipe/processes/images/CloneResidency.png" /></p>
<p>The points in the plot are jittered to avoid overplotting. The x-axis is the residency in the first group and
the y-axis is the residency in the second group. The size of the points are relative to the normalized size of
the clones. You may identify different types of clones in the plot based on their residency in the two groups:<br /></p>
<ul>
<li>Collapsed (The clones that are collapsed in the second group)</li>
<li>Dual (The clones that are present in both groups with equal size)</li>
<li>Expanded (The clones that are expanded in the second group)</li>
<li>First Group Multiplet (The clones only in the First Group with size &gt; 1)</li>
<li>Second Group Multiplet (The clones only in the Second Group with size &gt; 1)</li>
<li>First Group Singlet (The clones only in the First Group with size = 1)</li>
<li>Second Group Singlet (The clones only in the Second Group with size = 1)</li>
</ul>
<p>This idea is borrowed from this paper:<br /></p>
<blockquote>
<p><a href="https://www.nature.com/articles/s41586-020-2056-8">Wu, Thomas D., et al. "Peripheral T cell expansion predicts tumour infiltration and clinical response." Nature 579.7798 (2020): 274-278.</a></p>
</blockquote>
</li>
<li>
<p>Venn diagrams showing the overlap of the clones in the two groups</p>
<p><img alt="CloneResidency_venn" src="https://pwwang.github.io/immunopipe/processes/images/CloneResidency_venn.png" width="60%" /></p>
</li>
</ul>
<h3 id="environment-variables">Environment Variables<a class="headerlink" href="#environment-variables" title="Permanent link">&para;</a></h3>
<ul>
<li><code>subject</code> <em>(<code>list</code>)</em>: <em>Default: <code>[]</code></em>. <br />
    The key of subject in metadata. The clone
    residency will be examined for this subject/patient</li>
<li><code>group</code>:
    The key of group in metadata. This usually marks the samples
    that you want to compare. For example, Tumor vs Normal,
    post-treatment vs baseline
    It doesn't have to be 2 groups always. If there are more than 3
    groups, instead of venn diagram, upset plots will be used.<br /></li>
<li><code>order</code> <em>(<code>list</code>)</em>: <em>Default: <code>[]</code></em>. <br />
    The order of the values in <code>group</code>. In scatter/residency plots,
    <code>X</code> in <code>X,Y</code> will be used as x-axis and <code>Y</code> will be used as y-axis.<br />
    You can also have multiple orders. For example: <code>["X,Y", "X,Z"]</code>.<br />
    If you only have two groups, you can set <code>order = ["X", "Y"]</code>, which will
    be the same as <code>order = ["X,Y"]</code>.<br /></li>
<li><code>section</code>:
    How the subjects aligned in the report. Multiple subjects with
    the same value will be grouped together.<br />
    Useful for cohort with large number of samples.<br /></li>
<li><code>mutaters</code> <em>(<code>type=json</code>)</em>: <em>Default: <code>{}</code></em>. <br />
    The mutaters passed to <code>dplyr::mutate()</code> on
    the cell-level data converted from <code>in.immdata</code>. If <code>in.metafile</code> is
    provided, the mutaters will be applied to the joined data.<br />
    The keys will be the names of the new columns, and the values will be the
    expressions. The new names can be used in <code>subject</code>, <code>group</code>, <code>order</code> and
    <code>section</code>.<br /></li>
<li><code>subset</code>:
    The filter passed to <code>dplyr::filter()</code> to filter the data for the cells
    before calculating the clone residency. For example, <code>Clones &gt; 1</code> to filter
    out singletons.<br /></li>
<li><code>prefix</code>: <em>Default: <code>{Sample}_</code></em>. <br />
    The prefix of the cell barcodes in the <code>Seurat</code> object.<br /></li>
<li><code>upset_ymax</code>:
    The maximum value of the y-axis in the upset bar plots.<br /></li>
<li><code>upset_trans</code>:
    The transformation to apply to the y axis of upset bar plots.<br />
    For example, <code>log10</code> or <code>sqrt</code>. If not specified, the y axis will be
    plotted as is. Note that the position of the bar plots will be dodged
    instead of stacked when the transformation is applied.<br />
    See also <a href="https://github.com/tidyverse/ggplot2/issues/3671">https://github.com/tidyverse/ggplot2/issues/3671</a></li>
<li><code>cases</code> <em>(<code>type=json</code>)</em>: <em>Default: <code>{}</code></em>. <br />
    If you have multiple cases, you can use this argument
    to specify them. The keys will be used as the names of the cases.<br />
    The values will be passed to the corresponding arguments.<br />
    If no cases are specified, the default case will be added, with
    the name <code>DEFAULT</code> and the values of <code>envs.subject</code>, <code>envs.group</code>,
    <code>envs.order</code> and <code>envs.section</code>. These values are also the
    defaults for the other cases.<br /></li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../RadarPlots/" class="btn btn-neutral float-left" title="RadarPlots"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ScFGSEA/" class="btn btn-neutral float-right" title="ScFGSEA">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  <div class="footer-notes">
    
    Version: <div id="mike-versions"></div>
    <div class="footer-sep"></div>
    <a href="https://github.com/pwwang/immunopipe" title="Open repository in GitHub">Github Repo</a>
    <div class="footer-sep"></div>Built with <a href="https://www.mkdocs.org/">MkDocs</a> using theme <a href="https://github.com/pwwang/mkdocs-rtd">mkdocs-rtd</a>.
  </div>
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../RadarPlots/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ScFGSEA/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
    <script src="../../js/version-select.js"></script>
      <script src="../../assets/script.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
